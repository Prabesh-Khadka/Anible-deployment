(self.webpackChunkmikha_angular_client=self.webpackChunkmikha_angular_client||[]).push([[682],{8682:function(t,e,i){"use strict";i.r(e),i.d(e,{AuditLogModule:function(){return P}});var o=i(1116),n=i(1041),a=i(4369),r=i(994),s=i(2935),u=i(3070),l=i(7307),d=i(9550),g=i(8150),p=i(3841),c=i(168),h=i(9199),f=i(5425),m=i(3576),Z=i(9831),v=i(6106),T=i(529),A=i(8512),F=i(7701),q=i(4689),y=i(1785),b=i(2693),S=i(6129),w=i(8320),L=i(5162),U=function(){function t(t,e,i){this.httpClient=t,this.basePath=w.Lt,this.defaultHeaders=new b.WM,this.configuration=new L.V,e&&(this.basePath=e),i&&(this.configuration=i,this.basePath=e||i.basePath||this.basePath),this.encoder=this.configuration.encoder||new S.H}return t.prototype.canConsumeForm=function(t){for(var e=0,i=t;e<i.length;e++)if("multipart/form-data"===i[e])return!0;return!1},t.prototype.findAllAuditLogUsingPOST=function(t,e,i,o,n,a){if(void 0===n&&(n="body"),void 0===a&&(a=!1),null==t)throw new Error("Required parameter dto was null or undefined when calling findAllAuditLogUsingPOST.");var r=new b.LE({encoder:this.encoder});null!=e&&(r=r.set("page",e)),null!=i&&(r=r.set("size",i)),o&&o.forEach(function(t){r=r.append("sort",t)});var s=this.defaultHeaders;this.configuration.apiKeys&&this.configuration.apiKeys.Authorization&&(s=s.set("Authorization",this.configuration.apiKeys.Authorization));var u=this.configuration.selectHeaderAccept(["*/*"]);null!=u&&(s=s.set("Accept",u));var l=this.configuration.selectHeaderContentType(["application/json"]);return null!=l&&(s=s.set("Content-Type",l)),this.httpClient.post(this.basePath+"/audit-log/get-all",t,{params:r,withCredentials:this.configuration.withCredentials,headers:s,observe:n,reportProgress:a})},t.prototype.getEventTypeListUsingGET=function(t,e){void 0===t&&(t="body"),void 0===e&&(e=!1);var i=this.defaultHeaders;this.configuration.apiKeys&&this.configuration.apiKeys.Authorization&&(i=i.set("Authorization",this.configuration.apiKeys.Authorization));var o=this.configuration.selectHeaderAccept(["*/*"]);return null!=o&&(i=i.set("Accept",o)),this.httpClient.get(this.basePath+"/audit-log/event-list",{withCredentials:this.configuration.withCredentials,headers:i,observe:t,reportProgress:e})},t.\u0275fac=function(e){return new(e||t)(y.LFG(b.eN),y.LFG(w.GW,8),y.LFG(L.V,8))},t.\u0275prov=y.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),x=i(486),_=i(9024),z=i(7064),C=i(9961);function D(t,e){1&t&&(y.TgZ(0,"mat-error"),y._uU(1,"Date To is required"),y.qZA())}function k(t,e){if(1&t&&(y.TgZ(0,"mat-option",20),y._uU(1),y.qZA()),2&t){var i=e.$implicit;y.Q6J("value",i),y.xp6(1),y.Oqu(i)}}function J(t,e){if(1&t&&(y.TgZ(0,"mat-option",20),y.TgZ(1,"div"),y.TgZ(2,"span"),y._uU(3),y.qZA(),y._uU(4,"\xa0( "),y.TgZ(5,"span"),y._uU(6),y.qZA(),y._uU(7,") "),y.qZA(),y.qZA()),2&t){var i=e.$implicit;y.Q6J("value",i),y.xp6(3),y.Oqu(i.name),y.xp6(3),y.Oqu(i.email)}}var N=function(){function t(t,e,i){var o=this;this.auditLogService=t,this.dialogRef=e,this.usersService=i,this.userCtrl=new n.NI,this.today=new Date,this.myError=function(t,e){return o.auditLogFilterForm.controls[t].hasError(e)}}return t.prototype.ngOnInit=function(){var t=this;this.getEventList(),this.auditLogFilterForm=new n.cw({dateFrom:new n.NI({value:"",disabled:!1},[]),dateTo:new n.NI({value:"",disabled:!0},[]),eventType:new n.NI,userId:new n.NI({value:"",disabled:!1},[])}),this.filteredUsers=this.userCtrl.valueChanges.pipe((0,F.b)(300),(0,q.w)(function(e){return e?t.usersService.usersSearchUsers(e):null}))},t.prototype.setDateTo=function(){var t=this.auditLogFilterForm.value.dateFrom;this.minDate=t,this.auditLogFilterForm.controls.dateTo.setValidators(n.kI.required),null!=t?this.auditLogFilterForm.controls.dateTo.enable():(this.auditLogFilterForm.controls.dateTo.disable(),this.auditLogFilterForm.controls.dateTo.setValue(null))},t.prototype.getEventList=function(){var t=this;this.auditLogService.getEventTypeListUsingGET().subscribe(function(e){t.eventList=e},function(t){alert("Error: "+t)})},t.prototype.filterAuditLog=function(t){var e,i,o;if(this.auditLogFilterForm.valid){if(this.auditLogFilterForm.value.dateFrom&&this.auditLogFilterForm.value.dateTo){var n=new Date(this.auditLogFilterForm.value.dateFrom),a=String(n.getDate()).padStart(2,"0"),r=String(n.getMonth()+1).padStart(2,"0");i=n.getFullYear()+"-"+r+"-"+a;var s=new Date(this.auditLogFilterForm.value.dateTo),u=String(s.getDate()).padStart(2,"0"),l=String(s.getMonth()+1).padStart(2,"0");o=s.getFullYear()+"-"+l+"-"+u}var d={dateFrom:i,dateTo:o,userId:null===(e=this.userCtrl.value)||void 0===e?void 0:e.id,event:"NONE"==this.auditLogFilterForm.value.eventType?null:this.auditLogFilterForm.value.eventType};this.dialogRef.close(d)}},t.prototype.displayFn=function(t){if(t)return t.name?t.name:t.email},t.prototype.closeDialog=function(){this.dialogRef.close()},t.\u0275fac=function(e){return new(e||t)(y.Y36(U),y.Y36(s.so),y.Y36(x.fz))},t.\u0275cmp=y.Xpm({type:t,selectors:[["app-audit-log-filter"]],decls:38,vars:16,consts:[["mat-dialog-title",""],[3,"formGroup","ngSubmit"],["formDirective","ngForm"],[1,"mat-typography"],["appearance","outline",1,"full-width"],["matInput","","name","dateFrom","formControlName","dateFrom",3,"matDatepicker","max","ngModelChange"],["matSuffix","",3,"for"],["dateFromPicker",""],["matInput","","name","dateTo","formControlName","dateTo",3,"matDatepicker","min","max"],["dateToPicker",""],[4,"ngIf"],["formControlName","eventType"],["value","NONE","aria-selected","true"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Created By",3,"matAutocomplete","formControl"],[1,"full-width",3,"displayWith"],["userAuto","matAutocomplete"],["align","end"],["type","submit","mat-button","","cdkFocusInitial","","color","primary"],["mat-button","","type","reset",3,"click"],[3,"value"]],template:function(t,e){if(1&t){var i=y.EpF();y.TgZ(0,"h2",0),y._uU(1,"Filter Audit Log"),y.qZA(),y.TgZ(2,"form",1,2),y.NdJ("ngSubmit",function(){y.CHM(i);var t=y.MAs(3);return e.filterAuditLog(t)}),y.TgZ(4,"mat-dialog-content",3),y.TgZ(5,"mat-form-field",4),y.TgZ(6,"mat-label"),y._uU(7,"Date From"),y.qZA(),y.TgZ(8,"input",5),y.NdJ("ngModelChange",function(){return e.setDateTo()}),y.qZA(),y._UZ(9,"mat-datepicker-toggle",6),y._UZ(10,"mat-datepicker",null,7),y.qZA(),y.TgZ(12,"mat-form-field",4),y.TgZ(13,"mat-label"),y._uU(14,"Date To"),y.qZA(),y._UZ(15,"input",8),y._UZ(16,"mat-datepicker-toggle",6),y._UZ(17,"mat-datepicker",null,9),y.YNc(19,D,2,0,"mat-error",10),y.qZA(),y.TgZ(20,"mat-form-field",4),y.TgZ(21,"mat-label"),y._uU(22,"Event Type"),y.qZA(),y.TgZ(23,"mat-select",11),y.TgZ(24,"mat-option",12),y._uU(25,"--NONE--"),y.qZA(),y.YNc(26,k,2,2,"mat-option",13),y.qZA(),y.qZA(),y.TgZ(27,"mat-form-field",4),y._UZ(28,"input",14),y.qZA(),y.TgZ(29,"mat-autocomplete",15,16),y.YNc(31,J,8,3,"mat-option",13),y.ALo(32,"async"),y.qZA(),y.qZA(),y.TgZ(33,"mat-dialog-actions",17),y.TgZ(34,"button",18),y._uU(35," Filter "),y.qZA(),y.TgZ(36,"button",19),y.NdJ("click",function(){return e.closeDialog()}),y._uU(37,"Close"),y.qZA(),y.qZA(),y.qZA()}if(2&t){var o,n=y.MAs(11),a=y.MAs(18),r=y.MAs(30);y.xp6(2),y.Q6J("formGroup",e.auditLogFilterForm),y.xp6(6),y.Q6J("matDatepicker",n)("max",e.today),y.xp6(1),y.Q6J("for",n),y.xp6(6),y.Q6J("matDatepicker",a)("min",e.minDate)("max",e.today),y.xp6(1),y.Q6J("for",a),y.xp6(3),y.Q6J("ngIf",e.myError("dateTo","required")),y.xp6(7),y.Q6J("ngForOf",e.eventList),y.xp6(2),y.Q6J("matAutocomplete",r)("formControl",e.userCtrl),y.xp6(1),y.Q6J("displayWith",e.displayFn),y.xp6(2),y.Q6J("ngForOf",null==(o=y.lcZ(32,14,e.filteredUsers))?null:o.results)}},directives:[s.uh,n._Y,n.JL,n.sg,s.xY,u.KE,u.hX,d.Nt,n.Fj,_.hl,n.JJ,n.u,_.nW,u.R9,_.Mq,o.O5,p.gD,z.ey,o.sg,C.ZL,n.oH,C.XC,s.H8,a.lW,u.TO],pipes:[o.Ov],styles:[""]}),t}(),O=i(2616),E=["sidenav"];function I(t,e){if(1&t&&(y.TgZ(0,"tr"),y.TgZ(1,"td"),y._uU(2),y.qZA(),y.TgZ(3,"td"),y._uU(4),y.qZA(),y.TgZ(5,"td"),y._uU(6),y.qZA(),y.TgZ(7,"td"),y._uU(8),y.qZA(),y.TgZ(9,"td"),y._uU(10),y.qZA(),y.TgZ(11,"td"),y._uU(12),y.qZA(),y.qZA()),2&t){var i=e.$implicit,o=y.oxw();y.xp6(2),y.Oqu(i.id),y.xp6(2),y.Oqu(i.data),y.xp6(2),y.hij(" ",o.datePipe.transform(i.date,"yyyy-MM-dd hh:mm:ss")," "),y.xp6(2),y.Oqu(i.event),y.xp6(2),y.Oqu(i.logType),y.xp6(2),y.Oqu(i.userId)}}var M=[{path:"",component:function(){function t(t,e){this.auditLogService=t,this.dialog=e,this.data=[],this.length=0,this.pageSize=T.N.pageSize,this.pageSizeOptions=T.N.pageSizeOptions,this.screenWidth$=new A.X(window.innerWidth)}return t.prototype.onResize=function(t){this.screenWidth$.next(t.target.innerWidth)},t.prototype.getScreenWidth=function(){return this.screenWidth$.asObservable()},t.prototype.ngOnInit=function(){var t=this;this.getScreenWidth().subscribe(function(e){e<1200?(t.showToggle="show",t.mode="over",t.openSidenav=!1):e>1200&&(t.showToggle="hide",t.mode="side",t.openSidenav=!0)}),this.getData({length:0,pageSize:this.pageSize,pageIndex:1})},t.prototype.setEvent=function(t){return console.log(t),this.pageEvent.pageIndex=t.pageIndex+1,this.pageEvent.pageSize=t.pageSize,this.pageEvent.length=0,this.pageEvent},t.prototype.getData=function(t){var e=this;return null!=this.auditLogFilterDto&&null!=this.auditLogFilterDto||(this.auditLogFilterDto={}),this.auditLogService.findAllAuditLogUsingPOST(this.auditLogFilterDto,t.pageIndex,t.pageSize).subscribe(function(t){e.data=t.content,e.length=t.totalElements,e.pageSize=t.size},function(t){alert("Error: "+t)}),t},t.prototype.filter=function(){var t=this;this.dialog.open(N,{width:"500px"}).afterClosed().subscribe(function(e){if(null!=e){var i={length:0,pageSize:t.pageSize,pageIndex:1};t.auditLogFilterDto=e,t.getData(i)}})},t.\u0275fac=function(e){return new(e||t)(y.Y36(U),y.Y36(s.uw))},t.\u0275cmp=y.Xpm({type:t,selectors:[["app-audit-log-view"]],viewQuery:function(t,e){var i;1&t&&y.Gf(E,5),2&t&&y.iGM(i=y.CRH())&&(e.matSidenav=i.first)},hostBindings:function(t,e){1&t&&y.NdJ("resize",function(t){return e.onResize(t)},!1,y.Jf7)},decls:36,vars:11,consts:[[1,"drawer-container"],[1,"drawer-sidenav",3,"mode","opened","fixedInViewport","fixedTopGap","fixedBottomGap"],["sidenav",""],[1,"inner-container",2,"height","100%"],[1,"row"],[1,"col-md-12","form-group"],[1,"col-md-6","form-group"],["mat-stroked-button","","color","primary",2,"margin-right","10px",3,"ngClass","click"],[1,"col-md-6",2,"text-align","right"],["mat-stroked-button","","color","primary",3,"click"],[1,"col-md-12"],[1,"table","table-bordered","table-striped"],[4,"ngFor","ngForOf"],[3,"length","pageSize","pageSizeOptions","page"]],template:function(t,e){if(1&t){var i=y.EpF();y.TgZ(0,"mat-sidenav-container",0),y.TgZ(1,"mat-sidenav",1,2),y._UZ(3,"app-settings-side-nav"),y.qZA(),y.TgZ(4,"mat-sidenav-content"),y.TgZ(5,"div",3),y.TgZ(6,"h2"),y._uU(7,"Audit Log"),y.qZA(),y.TgZ(8,"div",4),y.TgZ(9,"div",5),y.TgZ(10,"div",4),y.TgZ(11,"div",6),y.TgZ(12,"button",7),y.NdJ("click",function(){return y.CHM(i),y.MAs(2).toggle()}),y._uU(13," Settings "),y.qZA(),y.qZA(),y.TgZ(14,"div",8),y.TgZ(15,"button",9),y.NdJ("click",function(){return e.filter()}),y._uU(16," Filter "),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(17,"div",10),y.TgZ(18,"table",11),y.TgZ(19,"thead"),y.TgZ(20,"tr"),y.TgZ(21,"td"),y._uU(22,"Id"),y.qZA(),y.TgZ(23,"td"),y._uU(24,"Data"),y.qZA(),y.TgZ(25,"td"),y._uU(26,"Date"),y.qZA(),y.TgZ(27,"td"),y._uU(28,"Event"),y.qZA(),y.TgZ(29,"td"),y._uU(30,"Log Type"),y.qZA(),y.TgZ(31,"td"),y._uU(32,"User Id"),y.qZA(),y.qZA(),y.qZA(),y.TgZ(33,"tbody"),y.YNc(34,I,13,6,"tr",12),y.qZA(),y.qZA(),y.TgZ(35,"mat-paginator",13),y.NdJ("page",function(t){return e.pageEvent=e.getData(t)}),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA()}2&t&&(y.xp6(1),y.Q6J("mode",e.mode)("opened",e.openSidenav)("fixedInViewport",!0)("fixedTopGap",0)("fixedBottomGap",0)("opened",!0),y.xp6(11),y.Q6J("ngClass",e.showToggle),y.xp6(22),y.Q6J("ngForOf",e.data),y.xp6(1),y.Q6J("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[c.TM,c.JX,O.k,c.Rh,a.lW,o.mk,o.sg,g.NW],styles:[""]}),t}(),canActivate:[v.k],data:{role:"MikhaAdmin"}}],Q=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=y.oAB({type:t}),t.\u0275inj=y.cJS({imports:[[Z.Bz.forChild(M)],Z.Bz]}),t}(),P=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=y.oAB({type:t}),t.\u0275inj=y.cJS({imports:[[o.ez,n.u5,f.m,Q,c.SJ,m.SettingsModule,g.TU,l.Ps,s.Is,a.ot,u.lN,d.c,p.LD,r.p9,_.FA,z.XK,n.UX,C.Bb,h.p0]]}),t}()}}]);